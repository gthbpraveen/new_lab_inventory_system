{% extends "login_home.html" %}
{% block title %}Equipment by Location & Staff{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto p-6">

  <h2 class="text-2xl font-bold text-indigo-800 mb-6">
    IT Equipment by Location & Faculty/Staff
  </h2>

  <!-- Filter Form -->
  <form method="get" class="mb-6 grid grid-cols-2 gap-6 bg-white p-4 rounded-xl shadow border border-gray-200">
    
    <!-- Location Dropdown -->
    <div>
      <label class="block mb-2">Location</label>
      <select id="location" name="location"
        class="block w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-yellow-500">
        <option value="">-- Select Location --</option>
        <optgroup label="Labs">
          {% set lab_list = [
            'CS-107','CS-108','CS-109',
            'CS-207','CS-208','CS-209',
            'CS-317','CS-318','CS-319','CS-320',
            'CS-411','CS-412'
          ] %}
          {% for l in lab_list %}
            <option value="{{l}}" {% if request.args.get('location')==l %}selected{% endif %}>{{l}}</option>
          {% endfor %}
        </optgroup>
        <optgroup label="Other Locations">
          {% set other_locations = [
            'CSE Office','CSE Store','Institute Datacenter','SmartRack'
          ] %}
          {% for o in other_locations %}
            <option value="{{o}}" {% if request.args.get('location')==o %}selected{% endif %}>{{o}}</option>
          {% endfor %}
        </optgroup>
      </select>
    </div>

    <!-- Intender Dropdown -->
    <div>
      <label class="block mb-2">Select Faculty / Staff</label>
      <select id="intender_name" name="intender_name"
        class="block w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-green-500">
        <option value="">-- Select Faculty / Staff --</option>

        <optgroup label="Faculty">
          {% set faculty_list = [
            'Prof. Antony Franklin','Dr. Ashish Mishra','Prof. Bheemarjuna Reddy Tamma',
            'Prof. C. Krishna Mohan','Dr. J. Saketha Nath','Dr. Jyothi Vedurada',
            'Dr. Kotaro Kataoka','Prof. M. V. Panduranga Rao','Dr. Manish Singh',
            'Dr. Maria Francis','Prof. Maunendra Sankar Desarkar','Dr. N. R. Aravind',
            'Dr. Nitin Saurabh','Dr. Praveen Tammana','Dr. Rajesh Kedia',
            'Dr. Rakesh Venkat','Dr. Ramakrishna Upadrasta','Dr. Rameshwar Pratap',
            'Dr. Rogers Mathew','Prof. Sathya Peri','Dr. Saurabh Kumar',
            'Dr. Shirshendu Das','Dr. Sobhan Babu','Dr. Srijith P. K.',
            'Prof. Subrahmanyam Kalyanasundaram','Prof. Vineeth N. Balasubramanian'
          ] %}
          {% for f in faculty_list %}
            <option value="{{f}}" {% if request.args.get('intender_name')==f %}selected{% endif %}>{{f}}</option>
          {% endfor %}
        </optgroup>

        <optgroup label="Staff">
          {% set staff_list = [
            'G Praveen Kumar','Shiva Kumar Reddy','Sunitha M',
            'Nikith Reddy','Vijay Chakravarthy','Syam N'
          ] %}
          {% for s in staff_list %}
            <option value="{{s}}" {% if request.args.get('intender_name')==s %}selected{% endif %}>{{s}}</option>
          {% endfor %}
        </optgroup>
      </select>
    </div>

    <div class="col-span-2 flex justify-end">
      <button type="submit"
        class="bg-indigo-600 text-white px-6 py-2 rounded-lg shadow hover:bg-indigo-700">
        Search
      </button>
    </div>
  </form>

  <!-- Equipment by Status (Shown Only After Filter) -->
  {% if request.args.get('location') or request.args.get('intender_name') %}
    {% for status, eq_list in {
        'Available': available_equipment,
        'Issued': issued_equipment,
        'Scrapped': scrapped_equipment,
        'Retired': retired_equipment
    }.items() %}
    <div class="bg-white rounded-xl shadow p-4 border border-gray-200 mb-6">
      <h3 class="text-xl font-semibold text-gray-800 mb-3">{{ status }} Equipment</h3>
      {% if eq_list %}
      <table class="min-w-full text-center border">
        <thead class="bg-gray-100 text-gray-700">
          <tr>
            <th class="px-4 py-2 border-b">Category</th>
            <th class="px-4 py-2 border-b">Serial</th>
            <th class="px-4 py-2 border-b">Model</th>
            <th class="px-4 py-2 border-b">Location</th>
            <th class="px-4 py-2 border-b">Intender</th>
          </tr>
        </thead>
        <tbody>
          {% for eq in eq_list %}
          <tr>
            <td class="px-4 py-2 border">{{ eq.category }}</td>
            <td class="px-4 py-2 border">{{ eq.serial_number }}</td>
            <td class="px-4 py-2 border">{{ eq.manufacturer }} {{ eq.model }}</td>
            <td class="px-4 py-2 border">{{ eq.location }}</td>
            <td class="px-4 py-2 border">{{ eq.intender_name }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      {% else %}
      <p class="text-gray-500">No {{ status.lower() }} equipment found.</p>
      {% endif %}
    </div>
    {% endfor %}
  {% endif %}

</div>
{% endblock %}
