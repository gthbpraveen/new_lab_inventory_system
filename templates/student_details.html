{% extends "login_home.html" %}
{% block title %}Student Details{% endblock %}
{% block content %}

<div class="max-w-6xl mx-auto py-10">

  <div class="bg-blue-900 text-white text-center py-3 rounded-lg shadow-md mb-6">
      <h1 class="text-xl font-semibold tracking-wide">
        {{ student.name }} ({{ student.roll }}) â€” Lab Allocation & Inventory Report
      </h1>
  </div>

  <!-- ğŸ‘¤ Student Profile -->
  <div class="bg-white border rounded-lg shadow-sm p-5 mb-6">
    <h2 class="text-lg font-semibold text-blue-800 mb-3">ğŸ‘¤ Student Profile</h2>
    <table class="w-full text-sm border border-gray-300">
      <tbody>
        <tr><th class="border px-3 py-2 bg-gray-50">Name</th><td class="border px-3 py-2">{{ student.name }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Roll</th><td class="border px-3 py-2">{{ student.roll }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Course</th><td class="border px-3 py-2">{{ student.course }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Year</th><td class="border px-3 py-2">{{ student.year }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Email</th><td class="border px-3 py-2">{{ student.email }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Phone</th><td class="border px-3 py-2">{{ student.phone }}</td></tr>
      </tbody>
    </table>
  </div>

  <!-- ğŸª‘ Cubicle -->
  <div class="bg-white border rounded-lg shadow-sm p-5 mb-6">
    <h2 class="text-lg font-semibold text-green-800 mb-3">ğŸª‘ Cubicle Allocation</h2>
    {% if student.cubicle %}
    <table class="w-full text-sm border border-gray-300">
      <tbody>
        <tr><th class="border px-3 py-2 bg-gray-50">Lab</th><td class="border px-3 py-2">{{ student.cubicle.room_lab.name }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Cubicle No</th><td class="border px-3 py-2">{{ student.cubicle.number }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Faculty</th><td class="border px-3 py-2">{{ student.faculty }}</td></tr>
        <tr><th class="border px-3 py-2 bg-gray-50">Staff In-Charge</th><td class="border px-3 py-2">{{ student.cubicle.room_lab.staff_incharge }}</td></tr>
      </tbody>
    </table>
    {% else %}
    <p class="text-red-600 font-semibold">âŒ Not Assigned</p>
    {% endif %}
  </div>

  <!-- ğŸ’» Workstations -->
  <div class="bg-white border rounded-lg shadow-sm p-5 mb-6">
    <h2 class="text-lg font-semibold text-purple-800 mb-3">ğŸ’» Workstation Allocation</h2>
    {% if workstation_assignments %}
    <div class="overflow-x-auto">
      <table class="w-full text-sm border border-gray-300">
        <thead class="bg-gray-100">
          <tr>
            <th class="border px-3 py-2">Name</th>
            <th class="border px-3 py-2">Category</th>
            <th class="border px-3 py-2">Serial</th>
            <th class="border px-3 py-2">Status</th>
            <th class="border px-3 py-2">Issued</th>
            <th class="border px-3 py-2">Required Till</th>
            <th class="border px-3 py-2">Returned</th>
          </tr>
        </thead>
        <tbody>
        {% for ws in workstation_assignments %}
          <tr>
            <td class="border px-3 py-2">{{ ws.asset.manufacturer or ws.asset.otherManufacturer }}</td>
            <td class="border px-3 py-2">{{ ws.asset.model }}</td>
            <td class="border px-3 py-2">{{ ws.asset.serial }}</td>
            <td class="border px-3 py-2">
              {% if ws.is_active %}<span class="text-green-600 font-semibold">ğŸŸ¢ Active</span>
              {% else %}<span class="text-red-600 font-semibold">Returned</span>{% endif %}
            </td>
            <td class="border px-3 py-2">{{ ws.issue_date }}</td>
            <td class="border px-3 py-2">{{ ws.system_required_till }}</td>
            <td class="border px-3 py-2">{{ ws.end_date or 'â€”' }}</td>
          </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <p class="text-red-600 font-semibold">âŒ None</p>
    {% endif %}
  </div>

  <!-- ğŸ–¥ Equipment -->
  <div class="bg-white border rounded-lg shadow-sm p-5 mb-6">
    <h2 class="text-lg font-semibold text-indigo-800 mb-3">ğŸ–¥ IT Equipment Allocation</h2>
    {% if equipment_history %}
    <table class="w-full text-sm border border-gray-300">
      <thead class="bg-gray-100">
        <tr>
          <th class="border px-3 py-2">Name</th>
          <th class="border px-3 py-2">Category</th>
          <th class="border px-3 py-2">Serial</th>
          <th class="border px-3 py-2">Issued</th>
          <th class="border px-3 py-2">Returned</th>
          <th class="border px-3 py-2">Status</th>
          <th class="border px-3 py-2">Assigned By</th>
        </tr>
      </thead>
      <tbody>
      {% for h in equipment_history %}
        <tr>
          <td class="border px-3 py-2">{{ h.equipment_obj.name }}</td>
          <td class="border px-3 py-2">{{ h.equipment_obj.category }}</td>
          <td class="border px-3 py-2">{{ h.equipment_obj.serial_number }}</td>
          <td class="border px-3 py-2">{{ h.assigned_date or 'â€”' }}</td>
          <td class="border px-3 py-2">{{ h.unassigned_date or 'â€”' }}</td>
          <td class="border px-3 py-2">
            {% if h.unassigned_date %}<span class="text-red-600 font-semibold">Returned</span>
            {% else %}<span class="text-green-600 font-semibold">ğŸŸ¢ Active</span>{% endif %}
          </td>
          <td class="border px-3 py-2">{{ h.staff_incharge }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p class="text-red-600 font-semibold">âŒ None</p>
    {% endif %}
  </div>

  <!-- âš¡ Slurm -->
  <div class="bg-white border rounded-lg shadow-sm p-5">
    <h2 class="text-lg font-semibold text-yellow-700 mb-3">âš¡ Slurm Account</h2>
    {% if slurm_exists %}
      <p class="text-green-700 font-semibold">âœ… Exists â€” Status: {{ slurm_status }}</p>
    {% else %}
      <p class="text-red-600 font-semibold">âŒ No Slurm Account</p>
    {% endif %}
  </div>

  <p class="text-right mt-6 text-gray-600 italic">
    Staff In-Charge: {{ student.cubicle.room_lab.staff_incharge if student.cubicle else 'â€”' }}
  </p>

</div>

{% endblock %}
