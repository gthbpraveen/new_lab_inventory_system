{% extends layout %}
{% block title %}CSE Labs{% endblock %}
{% block content %}

<!-- Hero Section -->
<div class="group relative overflow-hidden backdrop-blur-md bg-gradient-to-br from-blue-600 via-white-800 to-indigo-600 bg-white/70 border border-gray-200 rounded-xl shadow-lg  p-8 flex flex-col justify-center items-center ">
  <div class="container mx-auto px-4 text-center">
    <h1 class="text-5xl text-white font-bold mb-4">CSE Labs @ IITH</h1>
    <p class="text-lg text-indigo-100 max-w-2xl mx-auto">
      Explore lab spaces designed for cutting-edge research, teaching, and student innovation.
    </p>
  </div>
</div>

<!-- Grouped Lab Cards by Floor -->
<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-16">
  {% set grouped = {} %}
  {% for lab in labs %}
    {% if grouped[lab.floor] is not defined %}
      {% set _ = grouped.update({lab.floor: []}) %}
    {% endif %}
    {% set _ = grouped[lab.floor].append(lab) %}
  {% endfor %}

  {% for floor, floor_labs in grouped.items() %}
    <h2 class="text-2xl text-center text-gray-800 mb-6">{{ floor }} Labs</h2>
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8 mb-12">
      {% for lab in floor_labs %}
        <div class="rounded-lg shadow hover:shadow-xl transition duration-300 border-t-4 border-{{ lab.color }}-400 bg-{{ lab.color }}-50">
          <div class="p-6 flex flex-col h-full">
            <!-- Lab Title & Info -->
            <h3 class="text-xl font-semibold text-gray-900 mb-1">{{ lab.name }}</h3>
            <p class="text-gray-600 mb-1">{{ lab.desc }}</p>
            <p class="text-sm text-gray-500 mb-2">
              Total Seating Capacity: <strong>{{ lab.count }}</strong>
            </p>

            <!-- Tags -->
            <div class="flex flex-wrap gap-2 mb-4">
              {% for tag in lab.tags %}
                <span class="px-3 py-1 bg-{{ lab.color }}-200 text-{{ lab.color }}-900 text-sm rounded-full">
                  {{ tag }}
                </span>
              {% endfor %}
            </div>

            <!-- Action Buttons -->
            <div class="mt-auto flex flex-col space-y-2">
              <!-- View Lab Details -->
              <a href="{{ url_for('lab_details', lab_code=lab.code) }}"
                 class="inline-flex items-center justify-center px-4 py-2 bg-{{ lab.color }}-300 text-black rounded-md hover:bg-{{ lab.color }}-400 transition">
                üîç View Lab Details
              </a>

              <!-- Lab Calendar -->
              {% if lab.code in ['CS-109', 'CS-209'] %}
                <a href="{{ url_for('lab_calender', lab=lab.code) }}"
                   class="inline-flex items-center justify-center px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition">
                  üóìÔ∏è Lab Schedule
                </a>
              {% endif %}

              <!-- Student Machine Allotment -->
              <a href="{{ url_for('lab_allotments', lab_code=lab.code) }}"
                 class="inline-flex items-center justify-center px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition">
                üíª Student Allotments view
              </a>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% endfor %}
</div>

{% endblock %}
